<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G·ª≠i File - H·ªá th·ªëng truy·ªÅn file b·∫£o m·∫≠t</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üì§ G·ª≠i File B·∫£o M·∫≠t</h1>
            <p class="subtitle">M√£ h√≥a v√† k√Ω s·ªë file tr∆∞·ªõc khi g·ª≠i</p>
        </header>

        <main class="main-content">
            <!-- User Registration Section -->
            <section class="user-section">
                <div class="form-group">
                    <label for="sender-id">ID Ng∆∞·ªùi g·ª≠i:</label>
                    <input type="text" id="sender-id" class="form-control" placeholder="Nh·∫≠p ID c·ªßa b·∫°n">
                    <button id="register-btn" class="btn btn-primary" style="margin-top: 0.5rem;">
                        ƒêƒÉng k√Ω / K·∫øt n·ªëi
                    </button>
                </div>
                
                <div id="connection-status" class="alert alert-info" style="display: none;"></div>
            </section>

            <!-- Key Management Section -->
            <section id="key-section" style="display: none;">
                <h2>üîë Qu·∫£n l√Ω kh√≥a</h2>
                <div class="key-info">
                    <div class="form-group">
                        <label>Kh√≥a c√¥ng khai c·ªßa b·∫°n:</label>
                        <textarea id="public-key-display" class="form-control" rows="5" readonly></textarea>
                    </div>
                    <div class="form-group">
                        <label for="private-key-input">Nh·∫≠p kh√≥a ri√™ng t∆∞ c·ªßa b·∫°n:</label>
                        <textarea id="private-key-input" class="form-control" rows="5" 
                                  placeholder="Paste your private key here..."></textarea>
                        <small style="color: #666;">‚ö†Ô∏è Kh√≥a ri√™ng t∆∞ ch·ªâ ƒë∆∞·ª£c l∆∞u locally, kh√¥ng g·ª≠i l√™n server</small>
                    </div>
                </div>
            </section>

            <!-- File Upload Section -->
            <section id="file-section" style="display: none;">
                <h2>üìÅ Ch·ªçn file ƒë·ªÉ g·ª≠i</h2>
                <div class="file-upload-area">
                    <div class="file-input-wrapper">
                        <input type="file" id="file-input" accept=".txt,.pdf,.png,.jpg,.jpeg,.gif,.doc,.docx,.json,.xml">
                        <label for="file-input" class="file-input-label">
                            <span>üìé</span>
                            <span>Ch·ªçn file</span>
                        </label>
                    </div>
                    <div id="file-info" style="margin-top: 1rem;"></div>
                </div>

                <!-- File Editor (for text files) -->
                <div id="file-editor" class="file-editor" style="display: none;">
                    <h3>‚úèÔ∏è Ch·ªânh s·ª≠a n·ªôi dung file</h3>
                    <textarea id="file-content" class="form-control"></textarea>
                    <button id="save-changes-btn" class="btn btn-success" style="margin-top: 0.5rem;">
                        L∆∞u thay ƒë·ªïi
                    </button>
                </div>
            </section>

            <!-- Recipient Selection -->
            <section id="recipient-section" style="display: none;">
                <h2>üë§ Ch·ªçn ng∆∞·ªùi nh·∫≠n</h2>
                <div class="form-group">
                    <label for="recipient-id">ID Ng∆∞·ªùi nh·∫≠n:</label>
                    <input type="text" id="recipient-id" class="form-control" 
                           placeholder="Nh·∫≠p ID ng∆∞·ªùi nh·∫≠n">
                    <button id="get-recipient-key-btn" class="btn btn-secondary" style="margin-top: 0.5rem;">
                        L·∫•y kh√≥a c√¥ng khai
                    </button>
                </div>
                
                <div id="recipient-key-info" style="display: none;">
                    <div class="alert alert-success">
                        ‚úÖ ƒê√£ l·∫•y kh√≥a c√¥ng khai c·ªßa ng∆∞·ªùi nh·∫≠n
                    </div>
                </div>

                <!-- Online Users List -->
                <div class="user-list" style="margin-top: 2rem;">
                    <h3>Ng∆∞·ªùi d√πng online</h3>
                    <div id="online-users-list"></div>
                </div>
            </section>

            <!-- Send File Section -->
            <section id="send-section" style="display: none;">
                <h2>üöÄ G·ª≠i file</h2>
                <div class="send-summary">
                    <div class="alert alert-info">
                        <p><strong>File:</strong> <span id="send-file-name"></span></p>
                        <p><strong>K√≠ch th∆∞·ªõc:</strong> <span id="send-file-size"></span></p>
                        <p><strong>Ng∆∞·ªùi nh·∫≠n:</strong> <span id="send-recipient"></span></p>
                    </div>
                </div>
                
                <button id="encrypt-and-send-btn" class="btn btn-primary btn-large">
                    <span class="btn-icon">üîê</span>
                    <span>M√£ h√≥a v√† g·ª≠i</span>
                </button>
                
                <div id="send-progress" style="display: none; margin-top: 1rem;">
                    <div class="progress">
                        <div class="progress-bar" style="width: 0%">0%</div>
                    </div>
                    <p id="progress-status"></p>
                </div>
                
                <div id="send-result" style="display: none; margin-top: 1rem;"></div>
            </section>

            <!-- Transfer History -->
            <section id="history-section" style="display: none;">
                <div class="transfer-history">
                    <h2>üìú L·ªãch s·ª≠ g·ª≠i file</h2>
                    <div id="transfer-history-list"></div>
                </div>
            </section>
        </main>

        <footer>
            <p>&copy; 2024 Secure File Transfer System. <a href="/" style="color: white;">Trang ch·ªß</a></p>
        </footer>
    </div>

    <!-- Socket.io -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <!-- CryptoJS for client-side encryption -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <!-- JSEncrypt for RSA -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.3.2/jsencrypt.min.js"></script>
    <!-- Application Scripts -->
    <script src="{{ url_for('static', filename='js/crypto.js') }}"></script>
    <script src="{{ url_for('static', filename='js/socket.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        // Initialize sender interface
        document.addEventListener('DOMContentLoaded', function() {
            initializeSenderInterface();
        });
    </script>
</body>
</html>